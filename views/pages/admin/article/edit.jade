extends ../layout
block main
  div#admin-main
    form(method="post")
      input.hide(name="_id", value="#{article._id}")
      .form-group
        span 文章标题
        input(name="title", value="#{article.title}")
      .form-group
        span 英文标题（作为URL标识文章，为带空格的单词或句子）
        input(name="title_short", value="#{article.title_short}")
      .form-group
        span 作者
        select(name="author")
          each member in memberList
            option(value="#{member._id}") #{member.username}
      .form-group
        span 标签
        input(name="tag", value="#{article.tag}")
      .form-group
        span 摘要
        input(name="summary", value="#{article.summary}")
      .form-group
        span 文章内容（请使用MarkDown语法）
        textarea(name="content[source]")
          | !{article.content.source}
      input(type="button", value="预览", id="preview")
      .form-group
        input(type="submit", value="提交")
    .article(style="background-color: #fff; width: 800px")

block jsCode
  script.
    $(function () {
      $('select[name="author"]').val('#{article.author._id}');

      $('#preview').click(function () {
        var content = $('textarea[name="content[source]"]').val();
        $.post('lib/admin/article/preview', {content: content},function (data) {
          $('.article').html(data);
        })
      })
    })
